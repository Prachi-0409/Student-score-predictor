# -*- coding: utf-8 -*-
"""model_train

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/13odxO43jOi7Hn6C2x3MfeWJ7CT99bjiC
"""

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor
import joblib

df = pd.read_csv("student-scores.csv")

df.drop(['id', 'first_name', 'last_name', 'email', 'gender', 'career_aspiration', 'part_time_job'], axis=1, inplace=True)

df['extracurricular_activities'] = df['extracurricular_activities'].astype(int)
df['attendance'] = 100 - df['absence_days']
df.drop('absence_days', axis=1, inplace=True)

subject_scores = ['math_score', 'history_score', 'physics_score', 'chemistry_score',
                  'biology_score', 'english_score', 'geography_score']
df['average_score'] = df[subject_scores].mean(axis=1)

df.drop(subject_scores, axis=1, inplace=True)

df.head()

X = df[['weekly_self_study_hours', 'attendance', 'extracurricular_activities']]
y = df['average_score']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

lr_model = LinearRegression()
lr_model.fit(X_train, y_train)
lr_pred = lr_model.predict(X_test)

rf_model = RandomForestRegressor(n_estimators=100, random_state=42)
rf_model.fit(X_train, y_train)
rf_pred = rf_model.predict(X_test)

rf_model = RandomForestRegressor(n_estimators=100, random_state=42)
rf_model.fit(X_train, y_train)
rf_pred = rf_model.predict(X_test)

joblib.dump(lr_model, "linear_regression_model.pkl")

joblib.dump(rf_model, "random_forest_model.pkl")

